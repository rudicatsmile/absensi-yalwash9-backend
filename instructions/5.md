Kebutuhan:
Tambahkan modul Holidays & Weekend Integration di Laravel 12 + Filament 4, TANPA integrasi API eksternal. Semua libur nasional dibuat manual oleh HR di Filament. Pastikan integrasi memengaruhi perhitungan Leave (exclude weekend/holiday) dan flag di Attendance. Tidak ada payroll.

### 1) Migration & Model
Buat tabel `holidays` bila belum ada:
- id
- date (date) — unique index
- name (string) — contoh: "Hari Kemerdekaan"
- type (enum: ['national','company','weekend']) — default 'national'
- is_official (boolean) — default false (boleh true untuk libur nasional resmi)
- timestamps

Model `Holiday`:
- Konstanta TYPE = ['national','company','weekend']
- Guarded/fillable sesuai fields
- Unique rule untuk `date`

### 2) Filament Resource
Buat `app/Filament/Resources/HolidayResource.php` dengan:
- Navigation: group "HR Settings" (atau "Master Data"), icon calendar
- Form:
  - DatePicker `date` (required, unique:holidays,date, ignore on edit)
  - TextInput `name` (required)
  - Select `type` (options: national, company, weekend) default national
  - Toggle `is_official` (default false)
- Table:
  - Columns:
    - TextColumn date (sortable, badge)
    - TextColumn name (searchable)
    - BadgeColumn type (colors: national=info, company=warning, weekend=gray)
    - IconColumn is_official (boolean)
    - TextColumn created_at (datetime, hidden on mobile)
  - Filters:
    - Tahun (select dinamis dari distinct YEAR(date))
    - Tipe (enum)
    - Official Only (scope is_official = true)
  - Row actions: Edit, Delete
  - Bulk actions: DeleteBulk, SetOfficial (is_official=true), UnsetOfficial (is_official=false)
  - Header actions:
    - Action "Generate Weekends (Year)": modal input `year` (default tahun berjalan), jalankan service untuk insert semua Sabtu/Minggu di tahun tsb sebagai records (type='weekend', name='Weekend', is_official=false). Idempotent (skip jika sudah ada). Tampilkan notifikasi jumlah inserted dan skipped.
    - Action "Quick Add National Holiday": modal (date, name) → type='national', is_official=true (shortcut input cepat)

### 3) Services/Helpers
Buat `app/Support/WorkdayCalculator.php`:
- `public static function isWeekend(Carbon $date): bool` — weekend Sabtu/Minggu
- `public static function isHoliday(Carbon $date): bool` — cek di tabel holidays pada kolom date
- `public static function isNonWorkingDay(Carbon $date): bool` — weekend OR holiday
- `public static function countWorkdaysExcludingHolidays(Carbon $start, Carbon $end): int`
  - Iterasi inklusif dari start..end, hitung hanya hari yang bukan weekend dan bukan holiday
  - Gunakan timezone app
- `public static function generateWeekendForYear(int $year): array`
  - Loop seluruh hari di tahun tsb; untuk Sabtu/Minggu insert holiday (type='weekend', name='Weekend', is_official=false)
  - Return `['inserted' => x, 'skipped' => y]`
  - Pastikan unique by date

Tambahkan binding di container bila perlu. Buat juga `app/Filament/Actions/GenerateWeekendAction.php` jika ingin action terpisah untuk reusability.

### 4) Integrasi ke Leave (tanpa ubah UI yang sudah ada)
- Pastikan perhitungan `total_days` pada pembuatan & approval Leave menggunakan:
  `WorkdayCalculator::countWorkdaysExcludingHolidays($startDate, $endDate)`
- Idempotent: pada `approve()`, hitung ulang total_days dengan fungsi di atas untuk konsistensi.
- Behavior: weekend/holiday TIDAK mengurangi leave balance (hanya hari kerja yang dihitung).
- Tambahkan unit helper kecil `LeaveDaysCalculator` jika ingin memisahkan logika dari controller, tapi boleh langsung pakai WorkdayCalculator.

### 5) Integrasi ke Attendance (tanpa payroll)
Pada flow check-in/check-out (service/controller yang sudah ada):
- Set flags:
  - `is_weekend = WorkdayCalculator::isWeekend($workDate)`
  - `is_holiday = WorkdayCalculator::isHoliday($workDate)`
- `holiday_work = true` hanya jika:
  - Hari tersebut weekend/holiday **dan** karyawan punya shift aktif (override di `shift_assignments` atau fallback `employees.default_shift_id`)
- Jangan hitung nominal; simpan hanya metrik operasional (late_minutes, early_leave_minutes, is_weekend, is_holiday, holiday_work).

### 6) Commands (manual only, tanpa API)
Buat `php artisan holidays:generate-weekends {year?}`:
- Year default tahun berjalan
- Panggil `WorkdayCalculator::generateWeekendForYear($year)`
- Tampilkan hasil inserted/skipped
Tidak perlu command sync API apa pun.

### 7) Validasi & UX
- Unique `date` di migration dan di Form Filament (Rule::unique()->ignoreRecord)
- Saat generate weekend:
  - Notifikasi sukses dengan ringkasan inserted/skipped
  - Idempotent: tidak error jika data sudah ada
- Resource dimasukkan ke Navigation agar HR mudah akses
- Pastikan Policy/Permission (opsional):
  - Hanya role/permission tertentu (mis. 'manage holidays') yang bisa create/update/delete
  - Daftarkan Policy di AuthServiceProvider dan aktifkan di Resource bila diperlukan

### 8) Testing
- Unit test WorkdayCalculator:
  - isWeekend untuk Sabtu/Minggu
  - isHoliday setelah insert manual holiday
  - countWorkdaysExcludingHolidays: range mencakup weekdays, weekend, dan tanggal holiday; pastikan hanya weekdays non-holiday yang dihitung
  - generateWeekendForYear menambah semua Sabtu/Minggu setahun, rerun tidak duplikasi
- Feature test Filament HolidayResource:
  - Create holiday (validasi unique date)
  - Filter by tahun & type
  - Bulk set/unset official
  - Header action Generate Weekends berjalan & idempotent

### 9) Catatan Teknis
- Gunakan timezone app (`config('app.timezone')`) saat menentukan "tanggal kerja".
- `holidays.date` harus disimpan dalam zona yang konsisten (tanggal lokal).
- enum `type` gunakan string tetap ['national','company','weekend'] (hindari magic string, gunakan konstanta di model).
- Tidak ada file atau kode untuk API import/sync libur nasional. Semua manual via Filament + generate weekend.

Output:
- Migration + Model Holiday
- Filament HolidayResource (form, table, filters, actions, bulk actions, header actions)
- WorkdayCalculator helper
- Command `holidays:generate-weekends`
- Integrasi perhitungan di Leave (exclude weekend/holiday) & flagging di Attendance
- Test dasar untuk helper & resource
